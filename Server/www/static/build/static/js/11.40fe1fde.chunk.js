(this["webpackJsonpmy-web"]=this["webpackJsonpmy-web"]||[]).push([[11],{131:function(e,t,n){"use strict";n.d(t,"h",(function(){return u})),n.d(t,"n",(function(){return l})),n.d(t,"m",(function(){return d})),n.d(t,"e",(function(){return h})),n.d(t,"a",(function(){return p})),n.d(t,"j",(function(){return f})),n.d(t,"b",(function(){return j})),n.d(t,"g",(function(){return b})),n.d(t,"d",(function(){return m})),n.d(t,"l",(function(){return O})),n.d(t,"i",(function(){return y})),n.d(t,"f",(function(){return v})),n.d(t,"c",(function(){return x})),n.d(t,"k",(function(){return k}));n(129);var r=n(59),a=n(152),s=n.n(a);function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";return new Promise((function(a){("GET"===n?s.a.get(e,{params:t}):s.a.post(e,t)).then((function(e){a(e.data)})).catch((function(e){r.b.error("\u8bf7\u6c42\u51fa\u9519\uff1a"+e.message)}))}))}var o=n(153),c=n.n(o),u=function(e,t){return i("/api/login",{username:e,password:t=c()(t)},"POST")},l=function(){return i("/api/user",{type:"get"},"POST")},d=function(e,t,n){return i("/api/user",{type:"update",username:e,password:t=c()(t),authority:n},"POST")},h=function(e){i("/api/user",{type:"del",username:e},"POST")},p=function(){return i("/api/authority",{type:"get"},"POST")},f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";i("/api/authority",{type:"update",name:e,menus:t},"POST")},j=function(e){i("/api/authority",{type:"del",name:e},"POST")},b=function(){return i("/api/favourites/favtype",{type:"get"},"POST")},m=function(e){return i("/api/favourites/favtype",{type:"del",title:e},"POST")},O=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return i("/api/favourites/favtype",{type:"update",title:e,rank:t,oldTitle:n},"POST")},y=function(e,t){return i("/api/favourites/favtype",{type:"move",fType:e,tType:t},"POST")},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return i("/api/favourites/favitem",{type:"get",favType:e},"POST")},x=function(e){return i("/api/favourites/favitem",{type:"del",url:e},"POST")},k=function(e,t,n,r,a){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;return i("/api/favourites/favitem",{type:"update",url:e,favType:t,title:n,rank:r,description:a,oldUrl:s},"POST")}},334:function(e,t,n){},335:function(e,t,n){},336:function(e,t,n){},353:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return X}));n(129);var r=n(59),a=(n(134),n(136)),s=n(39),i=n(40),o=n(42),c=n(41),u=(n(182),n(183)),l=n(0),d=n.n(l),h=n(7),p=n(68),f=n(70),j=(n(156),n(146)),b=n(66),m=n(360),O=n(359),y=n(358),v=n(355),x=n(357),k=n(356),g=[{key:"home",title:"\u9996\u9875",icon:m.a},{key:"statistics",title:"\u7edf\u8ba1",icon:O.a},{key:"manages",title:"\u7ba1\u7406",icon:y.a,children:[{key:"user",title:"\u7528\u6237\u7ba1\u7406",icon:v.a},{key:"authority",title:"\u89d2\u8272\u7ba1\u7406",icon:x.a}]},{key:"settings",title:"\u8bbe\u7f6e",icon:k.a,children:[{key:"base",title:"\u57fa\u7840\u8bbe\u7f6e",icon:k.a}]}],S=(n(334),n(131)),w=n(11),R=j.a.SubMenu,C=function(e){Object(o.a)(n,e);var t=Object(c.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).getMenuNodes=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=t.split("/");return e.map((function(e){return-1!==n.indexOf(e.key)?e.children?(e.children.find((function(e){return e.key===r.props.path.split("/")[2]}))&&(r.openKey=e.key),Object(w.jsx)(R,{icon:Object(w.jsx)(e.icon,{}),title:e.title,children:r.getMenuNodes(e.children,t)},e.key)):Object(w.jsx)(j.a.Item,{icon:Object(w.jsx)(e.icon,{}),children:Object(w.jsx)(b.b,{to:"/admin/"+e.key,children:e.title})},e.key):null}))},r.state={},Object(S.a)().then((function(e){r.authorityList=e.data;var t=r.authorityList.find((function(e){return e.name===p.a.userdata.authority}));r.setState({menuNodes:r.getMenuNodes(g,t.menus)})})),r}return Object(i.a)(n,[{key:"render",value:function(){return Object(w.jsxs)("div",{className:"left-nav",children:[Object(w.jsx)(b.b,{to:"/",className:"left-nav-header",children:Object(w.jsx)("h1",{children:"\u540e\u53f0\u7ba1\u7406"})}),Object(w.jsx)(j.a,{selectedKeys:[this.props.path.split("/")[2]],defaultOpenKeys:[this.openKey],mode:"inline",theme:"dark",children:this.state.menuNodes})]})}}]),n}(l.Component),T=(n(132),n(130)),U=(n(335),function(e){Object(o.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).getTitle=function(t){var n,r=e.props.path.split("/")[2];return t.forEach((function(t){if(t.key===r)n=t.title;else if(t.children){var a=e.getTitle(t.children);a&&(n=a)}})),n},e}return Object(i.a)(n,[{key:"render",value:function(){var e=this.getTitle(g);return Object(w.jsxs)("div",{className:"header",children:[Object(w.jsx)("div",{className:"header-title",children:e}),Object(w.jsxs)("div",{className:"header-user",children:[Object(w.jsxs)("span",{children:["\u6b22\u8fce\uff0c",this.props.username]}),Object(w.jsx)(T.a,{type:"link",onClick:this.props.logout,children:"\u9000\u51fa"})]})]})}}]),n}(l.Component)),N=(n(336),function(e){Object(o.a)(n,e);var t=Object(c.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return Object(w.jsx)("div",{className:"home",children:"\u6b22\u8fce\u4f7f\u7528\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf"})}}]),n}(l.Component)),K=function(e){Object(o.a)(n,e);var t=Object(c.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return Object(w.jsx)("div",{children:"Statistics"})}}]),n}(l.Component),P=(n(189),n(186)),I=(n(223),n(220)),F=(n(140),n(144)),A=(n(138),n(139)),M=(n(169),n(161)),z=M.a.Option,_=function(e){Object(o.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).formRef=d.a.createRef(),a.addUser=function(){a.formRef.current.validateFields().then((function(e){a.formRef.current.resetFields(),a.props.addUser(e.username,e.password,e.authority)})).catch((function(e){return r.b.error("\u8bf7\u6b63\u786e\u586b\u5199\u4fe1\u606f\uff01")}))},a.getOptions=function(e){return e.map((function(e){return Object(w.jsx)(z,{value:e.name,children:e.name},e.name)}))},a.state={},Object(S.a)().then((function(e){a.setState({options:a.getOptions(e.data)})})),a}return Object(i.a)(n,[{key:"render",value:function(){var e=this;return Object(w.jsx)(a.a,{title:"\u6dfb\u52a0\u7528\u6237",visible:1===this.props.showStatus,onOk:this.addUser,onCancel:function(){e.props.addUser()},children:Object(w.jsxs)(F.a,{ref:this.formRef,children:[Object(w.jsx)(F.a.Item,{name:"username",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"},{min:4,message:"\u7528\u6237\u540d\u6700\u5c114\u4f4d"},{max:12,message:"\u7528\u6237\u540d\u6700\u591a12\u4f4d"},{pattern:/^[a-zA-z0-9_*!]+$/,message:"\u7528\u6237\u540d\u5fc5\u987b\u7531\u82f1\u6587\u3001\u6570\u5b57\u6216\u82f1\u6587\u5b57\u7b26_*!\u7ec4\u6210"}],children:Object(w.jsx)(A.a,{placeholder:"\u7528\u6237\u540d"})}),Object(w.jsx)(F.a.Item,{name:"password",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801\uff01"},{min:6,message:"\u5bc6\u7801\u6700\u5c116\u4f4d"},{max:16,message:"\u5bc6\u7801\u6700\u591a16\u4f4d"},{pattern:/^[a-zA-z0-9_*!]+$/,message:"\u5bc6\u7801\u5fc5\u987b\u7531\u82f1\u6587\u3001\u6570\u5b57\u6216\u82f1\u6587\u5b57\u7b26_*!\u7ec4\u6210"}],children:Object(w.jsx)(A.a,{type:"password",placeholder:"\u5bc6\u7801"})}),Object(w.jsx)(F.a.Item,{name:"authority",initialValue:"root",children:Object(w.jsx)(M.a,{children:this.state.options})})]})})}}]),n}(l.Component),D=M.a.Option,E=function(e){Object(o.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).formRef=d.a.createRef(),a.setUser=function(){a.formRef.current.validateFields().then((function(e){a.formRef.current.resetFields(),e.password||(e.password=""),a.props.setUser(e.username,e.password,e.authority)})).catch((function(e){return r.b.error("\u8bf7\u6b63\u786e\u586b\u5199\u4fe1\u606f\uff01"+e)}))},a.getOptions=function(e){return e.map((function(e){return Object(w.jsx)(D,{value:e.name,children:e.name},e.name)}))},a.state={},Object(S.a)().then((function(e){a.setState({options:a.getOptions(e.data)})})),a}return Object(i.a)(n,[{key:"componentDidUpdate",value:function(){this.formRef.current&&(this.formRef.current.resetFields(),this.formRef.current.setFieldsValue({username:this.props.user.username}),this.formRef.current.setFieldsValue({authority:this.props.user.authority}))}},{key:"render",value:function(){var e=this;return Object(w.jsx)(a.a,{title:"\u6dfb\u52a0\u7528\u6237",visible:2===this.props.showStatus,onOk:this.setUser,onCancel:function(){e.props.setUser()},children:Object(w.jsxs)(F.a,{ref:this.formRef,children:[Object(w.jsx)(F.a.Item,{name:"username",children:Object(w.jsx)(A.a,{disabled:!0})}),Object(w.jsx)(F.a.Item,{name:"password",rules:[{min:6,message:"\u5bc6\u7801\u6700\u5c116\u4f4d"},{max:16,message:"\u5bc6\u7801\u6700\u591a16\u4f4d"},{pattern:/^[a-zA-z0-9_*!]+$/,message:"\u5bc6\u7801\u5fc5\u987b\u7531\u82f1\u6587\u3001\u6570\u5b57\u6216\u82f1\u6587\u5b57\u7b26_*!\u7ec4\u6210"}],children:Object(w.jsx)(A.a,{type:"password",placeholder:"\u5bc6\u7801\u9ed8\u8ba4\u4e0d\u4fee\u6539"})}),Object(w.jsx)(F.a.Item,{name:"authority",children:Object(w.jsx)(M.a,{children:this.state.options})})]})})}}]),n}(l.Component),q=function(e){Object(o.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={user:{},showStatus:0},e.updateUsers=function(){return Object(S.n)().then((function(t){return e.setState({users:t.data})}))},e.updateUser=function(t,n,a){t&&(Object(S.m)(t,n,a).then((function(t){"0"===t.status?(r.b.success("\u66f4\u65b0\u7528\u6237\u6210\u529f\uff01"),e.updateUsers()):r.b.error("\u66f4\u65b0\u7528\u6237\u5931\u8d25\uff01")})),e.setState({user:{}})),e.setState({showStatus:0})},e.delUser=function(){Object(S.e)(e.state.user.username).then((function(t){"0"===t.status?(r.b.success("\u5220\u9664\u7528\u6237\u6210\u529f\uff01"),e.updateUsers()):r.b.error("\u5220\u9664\u7528\u6237\u5931\u8d25\uff01")})),e.setState({user:{}})},e.onRow=function(t){return{onClick:function(n){return e.setState({user:t})}}},e.columns=[{title:"\u7528\u6237\u540d",dataIndex:"username"},{title:"\u5bc6\u7801",dataIndex:"password"},{title:"\u6240\u5c5e\u89d2\u8272",dataIndex:"authority"}],e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.updateUsers()}},{key:"render",value:function(){var e=this,t=this.state,n=t.users,r=t.user,a=t.showStatus,s=Object(w.jsxs)("span",{style:{lineHeight:"48px"},children:[Object(w.jsx)(T.a,{type:"primary",onClick:function(){e.setState({showStatus:1})},children:"\u521b\u5efa\u7528\u6237"})," \xa0",Object(w.jsx)(T.a,{type:"primary",onClick:this.delUser,disabled:!r.username,children:"\u5220\u9664\u7528\u6237"})," \xa0",Object(w.jsx)(T.a,{type:"primary",onClick:function(){e.setState({showStatus:2})},disabled:!r.username,children:"\u7f16\u8f91\u89d2\u8272"})]});return Object(w.jsxs)(P.a,{title:s,children:[Object(w.jsx)(I.a,{bordered:!0,rowKey:"username",dataSource:n,columns:this.columns,rowSelection:{type:"radio",selectedRowKeys:[r.username]},onRow:this.onRow}),Object(w.jsx)(_,{showStatus:a,addUser:function(t,n,r){e.updateUser(t,n,r)}}),Object(w.jsx)(E,{showStatus:a,user:this.state.user,setUser:function(t,n,r){e.updateUser(t,n,r)}})]})}}]),n}(l.Component),V=function(e){Object(o.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).formRef=d.a.createRef(),e.addRole=function(){e.formRef.current.validateFields().then((function(t){e.formRef.current.resetFields(),e.props.addRole(t.name)})).catch((function(e){r.b.error("\u8bf7\u6b63\u786e\u586b\u5199\u4fe1\u606f\uff01")}))},e}return Object(i.a)(n,[{key:"render",value:function(){var e=this;return Object(w.jsx)(a.a,{title:"\u6dfb\u52a0\u89d2\u8272",visible:1===this.props.showStatus,onOk:this.addRole,onCancel:function(){e.props.addRole()},children:Object(w.jsx)(F.a,{ref:this.formRef,children:Object(w.jsx)(F.a.Item,{name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d"},{max:12,message:"\u89d2\u8272\u540d\u6700\u591a12\u4f4d"}],children:Object(w.jsx)(A.a,{placeholder:"\u89d2\u8272\u540d"})})})})}}]),n}(l.Component),$=(n(342),n(344)),G=$.a.TreeNode,H=function(e){Object(o.a)(n,e);var t=Object(c.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).setRole=function(){var e="";r.state.checkedKeys.length&&(e=r.state.checkedKeys.reduce((function(e,t){return"all"===e?"":"all"===t?e:""===e?t:e+"/"+t}))),r.props.setRole(r.props.role.name,e)},r.getMenuNodes=function(e){return e.map((function(e){return e.children?Object(w.jsx)(G,{title:e.title,children:r.getMenuNodes(e.children)},e.key):Object(w.jsx)(G,{title:e.title},e.key)}))},r.onCheck=function(e){r.setState({checkedKeys:e})},r.state={checkedKeys:{}},r.menuNodes=r.getMenuNodes(g),r}return Object(i.a)(n,[{key:"render",value:function(){var e=this;return Object(w.jsx)(a.a,{title:"\u8bbe\u7f6e\u89d2\u8272\u6743\u9650",visible:2===this.props.showStatus,onOk:this.setRole,onCancel:function(){e.props.setRole()},children:Object(w.jsx)($.a,{checkable:!0,defaultExpandAll:!0,checkedKeys:this.state.checkedKeys,onCheck:this.onCheck,children:Object(w.jsx)(G,{title:"\u5e73\u53f0\u6743\u9650",children:this.menuNodes},"all")})})}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(0===e.showStatus){var n=e.role.menus?e.role.menus.split("/"):{};if(n!==t.checkedKeys)return{checkedKeys:n}}return null}}]),n}(l.Component),J=function(e){Object(o.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={role:{},showStatus:0},e.updateRoles=function(){Object(S.a)().then((function(t){e.setState({roles:t.data})}))},e.updateRole=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t&&(Object(S.j)(t,n).then((function(t){"0"===t.status?(r.b.success("\u66f4\u65b0\u89d2\u8272\u6210\u529f\uff01"),e.updateRoles()):r.b.error("\u66f4\u65b0\u89d2\u8272\u5931\u8d25\uff01")})),e.setState({role:{}})),e.setState({showStatus:0})},e.delRole=function(){Object(S.b)(e.state.role.name).then((function(t){"0"===t.status?(r.b.success("\u5220\u9664\u89d2\u8272\u6210\u529f\uff01"),e.updateRoles()):r.b.error("\u5220\u9664\u89d2\u8272\u5931\u8d25\uff01")})),e.setState({role:{}})},e.onRow=function(t){return{onClick:function(n){e.setState({role:t})}}},e.columns=[{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"name"},{title:"\u62e5\u6709\u6743\u9650",dataIndex:"menus"}],e}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.updateRoles()}},{key:"render",value:function(){var e=this,t=this.state,n=t.roles,r=t.role,a=t.showStatus,s=Object(w.jsxs)("span",{style:{lineHeight:"48px"},children:[Object(w.jsx)(T.a,{type:"primary",onClick:function(){e.setState({showStatus:1})},children:"\u521b\u5efa\u89d2\u8272"})," \xa0",Object(w.jsx)(T.a,{type:"primary",onClick:this.delRole,disabled:!r.name,children:"\u5220\u9664\u89d2\u8272"})," \xa0",Object(w.jsx)(T.a,{type:"primary",onClick:function(){e.setState({showStatus:2})},disabled:!r.name,children:"\u8bbe\u7f6e\u89d2\u8272\u6743\u9650"})]});return Object(w.jsxs)(P.a,{title:s,children:[Object(w.jsx)(I.a,{bordered:!0,rowKey:"name",dataSource:n,columns:this.columns,rowSelection:{type:"radio",selectedRowKeys:[r.name]},onRow:this.onRow}),Object(w.jsx)(V,{showStatus:a,addRole:function(t){e.updateRole(t)}}),Object(w.jsx)(H,{showStatus:a,role:this.state.role,setRole:function(t,n){e.updateRole(t,n)}})]})}}]),n}(l.Component),L=function(e){Object(o.a)(n,e);var t=Object(c.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return Object(w.jsx)("div",{children:"BaseSetting"})}}]),n}(l.Component),B=u.a.Footer,Q=u.a.Sider,W=u.a.Content,X=function(e){Object(o.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).logout=function(){a.a.confirm({title:"\u662f\u5426\u786e\u8ba4\u9000\u51fa\uff1f",content:"\u9000\u51fa\u540e\u518d\u6b21\u8fdb\u5165\u9700\u8981\u91cd\u65b0\u767b\u5f55",onOk:function(){f.a.removeUser(),p.a.userdata={},e.props.history.replace("/login")}})},e}return Object(i.a)(n,[{key:"render",value:function(){var e=p.a.userdata;return e&&"0"===e.status?Object(w.jsxs)(u.a,{style:{height:"100%"},children:[Object(w.jsx)(Q,{children:Object(w.jsx)(C,{path:this.props.location.pathname})}),Object(w.jsxs)(u.a,{children:[Object(w.jsx)(U,{path:this.props.location.pathname,logout:this.logout,username:e.username}),Object(w.jsx)(W,{style:{backgroundColor:"#fff"},children:Object(w.jsxs)(h.d,{children:[Object(w.jsx)(h.b,{path:"/admin/home",component:N}),Object(w.jsx)(h.b,{path:"/admin/statistics",component:K}),Object(w.jsx)(h.b,{path:"/admin/user",component:q}),Object(w.jsx)(h.b,{path:"/admin/authority",component:J}),Object(w.jsx)(h.b,{path:"/admin/base",component:L}),Object(w.jsx)(h.a,{to:"/admin/home"})]})}),Object(w.jsx)(B,{style:{textAlign:"center",color:"#ccc"},children:"\u63a8\u8350\u4f7f\u7528\u8c37\u6b4c\u6d4f\u89c8\u5668\uff0c\u53ef\u4ee5\u83b7\u5f97\u66f4\u4f73\u9875\u9762\u64cd\u4f5c\u4f53\u9a8c"})]})]}):(r.b.error("\u8bf7\u5148\u7684\u767b\u5f55\uff01"),Object(w.jsx)(h.a,{to:"/login"}))}}]),n}(l.Component)}}]);
//# sourceMappingURL=11.40fe1fde.chunk.js.map