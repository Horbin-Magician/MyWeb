{"version":3,"sources":["api/baseAPI.js","components/loginModal/loginModal.jsx","components/header/header.jsx","assets/imgs/beianIcon.png","components/footer/footer.jsx","components/loading/loading.jsx","App.js","index.js","utils/storageUtils.js","utils/userUtils.js","api/ajax.js","utils/memoryUtils.js"],"names":["reqLogin","username","password","md5","ajax","reqUserList","reqUpdateUser","authority","reqDelUser","reqAuthorityList","reqUpdateAuthority","name","menus","reqDelAuthority","LoginModal","onFinish","values","a","userlogin","data","status","props","switchShow","title","visible","this","showLogin","onCancel","footer","initialValues","Item","rules","required","message","min","max","pattern","prefix","UserOutlined","className","placeholder","LockOutlined","type","style","width","htmlType","Component","SubMenu","Header","onUserMenuClick","key","confirm","onOk","userlogout","history","push","switchLoginShow","setState","state","addUpdateFun","forceUpdate","userMenu","onClick","url","location","pathname","split","nowKey","length","userBtn","checkLogin","overlay","trigger","placement","arrow","shape","MenuOutlined","offsetTop","align","justify","mode","selectedKeys","icon","HomeOutlined","to","FileTextOutlined","ToolOutlined","withRouter","Footer","gutter","xs","sm","md","src","beianIcon","alt","target","rel","href","Loading","position","left","top","transform","size","Admin","lazy","Home","Passages","Tools","About","Error","App","initApp","initUser","config","fallback","minHeight","path","component","exact","ReactDOM","render","locale","zhCN","document","getElementById","USER_KEY","exportObject","saveUser","userdata","localStorage","setItem","JSON","stringify","getUser","parse","getItem","removeUser","removeItem","updateFuns","fun","update","forEach","e","Promise","resolve","then","success","memoryUtils","storageUtils","console","log","error","user","axios","get","params","post","response","catch"],"mappings":"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","file":"static/js/main.29e8f67c.chunk.js","sourcesContent":["/*\n包含应用中所有基础api\n */\nimport ajax from './ajax'\nimport md5 from 'md5'\n\n\n//登入\nexport const reqLogin = (username, password) => {\n    password = md5(password)\n    return ajax('/api/login', {username, password}, 'POST')\n}\n//获取用户列表\nexport const reqUserList = () => ajax('/api/user', {'type':'get'}, 'POST')\n//更新用户\nexport const reqUpdateUser = (username, password, authority) => {\n    password = md5(password)\n    return ajax('/api/user', {'type':'update', username, password, authority}, 'POST')\n}\n//删除用户\nexport const reqDelUser = (username) => {\n    return ajax('/api/user', {'type':'del', username}, 'POST')\n}\n//获取角色列表\nexport const reqAuthorityList = () => ajax('/api/authority', {'type':'get'}, 'POST')\n//更新角色\nexport const reqUpdateAuthority = (name, menus='') => {\n    return ajax('/api/authority', {'type':'update', name, menus}, 'POST')\n}\n//删除角色\nexport const reqDelAuthority = (name) => {\n    return ajax('/api/authority', {'type':'del', name}, 'POST')\n}","import {Component} from 'react'\nimport {Form, Input, Button, Modal} from 'antd';\nimport {UserOutlined, LockOutlined} from '@ant-design/icons';\n\nimport {userlogin} from '../../utils/userUtils'\n\n/*\n登录页的路由组件\n*/ \nexport default class LoginModal extends Component {\n  onFinish = async (values) => {\n    const {username, password} = values\n    const data = await userlogin(username, password)\n    if(data && data.status === '0')this.props.switchShow()\n  };\n\n  render() {\n    return (\n        <Modal title='用户登录'\n        visible={this.props.showLogin} onCancel={this.props.switchShow}\n        footer={null}>\n            <Form name=\"normal_login\" footer={null}\n            initialValues={{}}\n            onFinish={this.onFinish}>\n                <Form.Item name=\"username\"\n                rules={[\n                    {required: true,message: '请输入用户名'},\n                    {min: 4,message: '用户名最少4位'},\n                    {max: 12,message: '用户名最多12位'},\n                    {pattern: /^[a-zA-z0-9_*!]+$/,message: '用户名必须由英文、数字或英文字符_*!组成'},\n                ]}>\n                  <Input prefix={<UserOutlined className=\"site-form-item-icon\" />} placeholder=\"用户名\" />\n                </Form.Item>\n                <Form.Item name=\"password\"\n                rules={[\n                    {required: true,message: '请输入密码！'},\n                    {min: 6,message: '密码最少6位'},\n                    {max: 16,message: '密码最多16位'},\n                    {pattern: /^[a-zA-z0-9_*!]+$/,message: '密码必须由英文、数字或英文字符_*!组成'},\n                ]}>\n                  <Input prefix={<LockOutlined className=\"site-form-item-icon\" />} type=\"password\" placeholder=\"密码\"/>\n                </Form.Item>\n                <Form.Item>\n                  <Button style={{width:'100%'}} type=\"primary\" htmlType=\"submit\">登录</Button>\n                </Form.Item>\n            </Form>\n        </Modal>\n     );\n  }\n}","import React, { Component } from 'react'\nimport { Link, withRouter } from 'react-router-dom'\nimport { HomeOutlined, ToolOutlined, UserOutlined, MenuOutlined, FileTextOutlined } from '@ant-design/icons'\nimport { Menu, Row, Col, Button, Modal, Affix, Dropdown } from 'antd';\n\nimport LoginModal from '../loginModal/loginModal'\nimport { userlogout, checkLogin, addUpdateFun } from '../../utils/userUtils'\nimport './header.less'\n/*\n头部组件\n */\nconst { SubMenu, Item } = Menu\nclass Header extends Component {\n  constructor(props){\n    super(props)\n    this.state = {showLogin: false,}\n    addUpdateFun(()=>this.forceUpdate())\n  }\n\n  onUserMenuClick = ({key}) => {\n    if(key === 'logout'){\n      Modal.confirm({\n        title: '是否确认注销？',\n        onOk: ()=>userlogout(),//注销\n      })\n    }else if(key === 'manage'){\n      this.props.history.push('/admin')\n    }\n  }\n\n  switchLoginShow = () => this.setState({ showLogin: !this.state.showLogin, })\n\n  render() {\n    const userMenu = (\n      <Menu onClick={this.onUserMenuClick}>\n        <Menu.Item key=\"manage\">管理</Menu.Item>\n        <Menu.Item key=\"logout\">注销</Menu.Item>\n      </Menu>\n    )\n    //根据url获取nowKey\n    const url = this.props.history.location.pathname.split('/')\n    if(url[1] === 'admin')return null;//若为管理界面，隐藏header\n    let nowKey = url[url.length - 1] === '' ? 'home' : url[url.length - 1]\n    if(url[1] === 'passages') nowKey = 'passages'\n    // 判断是否已经登录\n    let userBtn = null\n    if(checkLogin()){\n      userBtn = (\n        <Dropdown overlay={userMenu} trigger={['click']} placement=\"bottomRight\" arrow>\n          <Button type=\"primary\" shape='circle'><MenuOutlined /></Button>\n        </Dropdown>\n      )\n    }else{\n      userBtn = <Button type=\"primary\" shape='circle' onClick={this.switchLoginShow}><UserOutlined /></Button>\n    }\n    // 渲染页面\n    return (\n      <Affix offsetTop={0}>\n        <Row className='header' align='middle' justify=\"center\">\n          <Col>\n            <Menu className='header-menu' mode=\"horizontal\" selectedKeys={[nowKey]}>\n              <Item key=\"home\" icon={<HomeOutlined />}>\n                <Link to={'/'}>源初</Link>\n              </Item>\n              <Item key=\"passages\" icon={<FileTextOutlined />}>\n                <Link to={'/passages'}>夕拾</Link>\n              </Item>\n              <SubMenu key=\"tools\" title=\"机巧\" icon={<ToolOutlined />}>\n                <Item key=\"favorites\">\n                  <Link to={'/tools/favorites'}>收藏夹</Link>\n                </Item>\n              </SubMenu>\n            </Menu>\n          </Col>\n        </Row>\n        <div className=\"userbtn\">{userBtn}</div>\n        <LoginModal switchShow={this.switchLoginShow} showLogin={this.state.showLogin} />\n      </Affix>\n    )\n  }\n}\nexport default withRouter(Header)","export default __webpack_public_path__ + \"static/media/beianIcon.0c577066.png\";","import { Component } from 'react'\nimport { withRouter, Link } from 'react-router-dom'\nimport { Row, Col} from 'antd';\n\nimport beianIcon from '../../assets/imgs/beianIcon.png';\nimport './footer.less'\n/*\n首页的路由组件\n*/\nclass Footer extends Component {\n  render() {\n    //若为管理界面，隐藏header\n    const url = this.props.history.location.pathname.split('/')\n    if(url[1] === 'admin')return null;\n    \n    return (\n      <Row className='footer' justify=\"center\" gutter={{ xs: 8, sm: 16, md: 24}}>\n        <Col>\n          <img src={beianIcon} alt='' />\n          <a target=\"_blank\" rel=\"noreferrer\" href=\"http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=42011102004461\">\n          鄂公网安备 42011102004461号</a>\n        </Col>\n        <Col>\n          <a href='https://beian.miit.gov.cn'>赣ICP备2021004310号-1</a>\n        </Col>\n        <Col>\n          <Link to=\"/about\">\n            ©2021 Horbin\n          </Link>\n        </Col>\n      </Row>\n    );\n  }\n}\nexport default withRouter(Footer)","import React, {Component} from 'react'\nimport {Spin} from 'antd'\n/*\n加载中组件\n用于在加载页面时显示\n */\nexport default class Loading extends Component{\n    render(){\n        return(\n            <div style={{position: 'absolute',left: '50%',top: '50%',\n            transform: 'translate(-50%, -50%)',}}>\n                <Spin size='large'/>\n            </div>\n        )\n    }\n}","import { Component, lazy, Suspense } from 'react'\nimport { BrowserRouter, Route, Switch } from 'react-router-dom'\nimport { message } from 'antd'\n\nimport Header from './components/header/header'\nimport Footer from './components/footer/footer'\nimport Loading from './components/loading/loading'\nimport { initUser } from './utils/userUtils'\n\nconst Admin = lazy(() => import('./pages/admin/admin'))\nconst Home = lazy(() => import('./pages/home/home'))\nconst Passages = lazy(() => import('./pages/passages/passages'))\nconst Tools = lazy(() => import('./pages/tools/tools'))\nconst About = lazy(() => import('./pages/about/about'))\nconst Error = lazy(() => import('./pages/others/error'))\n\nexport default class App extends Component {\n  constructor(props){\n    super(props)\n    this.initApp() //统一初始化App\n  }\n  initApp = ()=>{\n    initUser() //初始化User信息\n    message.config({top: 50})\n  }\n  render() {\n    return (\n      <BrowserRouter>\n        <Suspense fallback={<Loading />}>\n          <Header />\n          <div style={{minHeight:'calc(100% - 5rem)'}}>\n            <Switch>\n              <Route path='/passages' component={Passages}></Route>\n              <Route path='/tools' component={Tools}></Route>\n              <Route path='/about' component={About}></Route>\n              <Route path='/admin' component={Admin}></Route>\n              <Route path='/' exact component={Home}></Route>\n              <Route path='/' component={Error}></Route>\n            </Switch>\n          </div>\n          <Footer />\n        </Suspense>\n      </BrowserRouter>\n    );\n  }\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport { ConfigProvider } from 'antd'\nimport zhCN from 'antd/lib/locale/zh_CN'\n\nimport App from './App';\n\n\nReactDOM.render(\n  <ConfigProvider locale={zhCN} ><App /></ConfigProvider>,\n  document.getElementById('root')\n);","/*\n进行local数据存储管理的工具模块\n*/\nconst USER_KEY = 'user_key'\n\n//保存用户信息\nfunction saveUser(userdata) {\n  localStorage.setItem(USER_KEY, JSON.stringify(userdata))\n}\n//获取用户信息\nfunction getUser() {\n  return JSON.parse(localStorage.getItem(USER_KEY) || '{}')\n}\n//去除用户信息\nfunction removeUser() {\n  localStorage.removeItem(USER_KEY)\n}\nconst exportObject = { saveUser, getUser, removeUser }\nexport default exportObject","import { message } from 'antd';\n\nimport { reqLogin } from '../api/baseAPI'\nimport memoryUtils from './memoryUtils'\nimport storageUtils from './storageUtils'\n/**\n * 用户登录\n */\nlet updateFuns = [] //用户状态更新回调函数\n//添加回调\nexport const addUpdateFun = (fun) =>{\n  updateFuns.push(fun)\n}\n//更新时调用回调\nconst update = ()=>{\n  updateFuns.forEach(e=>{\n    e()\n  })\n}\n/**\n * \n * @param {*用户名} username \n * @param {*密码} password \n * @returns 结果promise\n */\nexport const userlogin = (username, password) => {\n  return new Promise((resolve) => {\n    reqLogin(username, password).then(data => {\n      if (data && data.status === '0') {//登入成功\n        message.success('登录成功，欢迎回来～')\n        const authority = data.authority\n        memoryUtils.userdata = { username, password, authority}\n        storageUtils.saveUser({ username, password, authority })\n        update()//更新\n      } else {//账号或密码错误\n        const user = storageUtils.getUser()\n        if (user.username){\n          storageUtils.removeUser()\n          memoryUtils.userdata = null\n          console.log('update')\n          update()//更新\n          message.error('用户信息已更新，请重新登录！')\n        }\n        else message.error('登录失败，账号或密码错误！')\n      }\n      resolve(data)\n    })\n  })\n}\n/**\n * 注销登录\n */\nexport const userlogout = () => {\n  storageUtils.removeUser()\n  memoryUtils.userdata = null\n  update()//更新\n  message.success('注销成功')\n}\n/**\n * 检查storage,并初始化用户信息\n */\nexport const initUser = () => {\n  const user = storageUtils.getUser()\n  if (user.username){\n    memoryUtils.userdata = user\n    return userlogin(user.username, user.password)\n  }\n  return null\n}\n/**\n * 检查是否的登录\n * @returns true or false\n */\nexport const checkLogin = () => {\n  if (memoryUtils.userdata && memoryUtils.userdata.username) {\n    return true\n  }\n  return false\n}","/*\n能发送异步ajax请求的函数模块\n函数返回promise对象\n */\nimport axios from 'axios'\nimport { message } from 'antd'\n\nexport default function ajax(url, data = {}, type = 'GET') {\n  return new Promise((resolve) => {\n    let promise\n    if (type === 'GET') { //发送GET请求\n      promise = axios.get(url, {\n        params: data\n      })\n    } else { //发送POST请求\n      promise = axios.post(url, data)\n    }\n    //获取promise，统一处理error\n    promise.then(response => {\n      resolve(response.data)\n    }).catch(error => {\n      message.error('请求出错：' + error.message)\n    })\n  })\n}","/*\n于内存中保存数据的工具模块\n*/\nvar userdata = {}\n\nconst exportObject = { userdata }\nexport default exportObject"],"sourceRoot":""}